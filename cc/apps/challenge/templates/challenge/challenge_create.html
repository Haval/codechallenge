{% extends 'base.html' %}

{% block contents %}

<form action="{% url 'challenge:create' %}" method="post" class="col-12 col-lg-5 text-left">
	{% csrf_token %}
	{% for field in form %}
		<div class="form-group">
			{{ field.label }}
			{{ field }}
			{{ field.errors }}
		</div>
	{% endfor %}

	<div id="js-rules">
		{{ rule_formset }}
		<button type="button" onclick="AddRule();">Add Rule</button>
	</div>

	<div class="form-group">
		<button type="submit" class="btn btn-primary btn-lg">Create</button>
	</div>
</form>

{% endblock %}

{% block extrascripts %}

<script type="text/javascript">
	var $totalForms = $('#id_rule_set-TOTAL_FORMS');
	var ruleCount = parseInt($totalForms.val());

	function AddRule() {
		$.get('/challenge/add_rule_template/' + ruleCount, function(data) {
			$('#js-rules').append(data);
			$totalForms.val(++ruleCount);
		});
	}

	function DeleteRule(btn) {
		$(btn).parents('[data-rule]').remove();
	}

</script>

{% endblock %}